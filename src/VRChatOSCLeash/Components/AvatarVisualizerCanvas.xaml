<UserControl
    x:Class="VRChatOSCLeash.AvatarVisualizerCanvas"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:VRChatOSCLeash"
    xmlns:canvas="using:Microsoft.Graphics.Canvas.UI.Xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:models="using:VRChatOSCLeash.Models"
    d:DataContext="{d:DesignInstance Type=local:AvatarVisualizerCanvas}"
    mc:Ignorable="d"
    d:DesignHeight="300"
    d:DesignWidth="400">

    <UserControl.Resources>
        <DataTemplate x:Key="LegendItemTemplate" x:DataType="local:LegendItem">
            <StackPanel Orientation="Horizontal" Spacing="4" ToolTipService.ToolTip="{x:Bind Description, Mode=OneTime}" HorizontalAlignment="Right">
                <TextBlock Text="{x:Bind Name, Mode=OneTime}"/>
                <Ellipse Width="12" Height="12">
                    <Ellipse.Fill>
                        <SolidColorBrush Color="{x:Bind Color, Mode=OneTime}"/>
                    </Ellipse.Fill>
                </Ellipse>
            </StackPanel>
        </DataTemplate>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="15" />
            <RowDefinition Height="auto" />
        </Grid.RowDefinitions>
        
        <canvas:CanvasControl x:Name="PlotCanvas" Draw="PlotCanvas_Draw" Grid.Row="0" />
        <canvas:CanvasControl x:Name="ScaleCanvas" Draw="ScaleCanvas_Draw" Height="50" Grid.Row="2" />

        <Grid HorizontalAlignment="Right" VerticalAlignment="Top" Padding="10" 
              Background="#aa0c0c0e" BorderBrush="#1cffffff" BorderThickness="2" CornerRadius="10">
            
            <Grid.RowDefinitions>
                <RowDefinition Height="auto" />
                <RowDefinition Height="auto" />
            </Grid.RowDefinitions>
            
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10" Grid.Row="0">
                <ToggleSwitch Header="Position Layer" IsOn="{x:Bind Settings.ShowPositionLayer, Mode=TwoWay}" HorizontalAlignment="Right" MinWidth="0"/>
                <ToggleSwitch Header="Stretch Layer" IsOn="{x:Bind Settings.ShowStretchLayer, Mode=TwoWay}" HorizontalAlignment="Right" MinWidth="0"/>
            </StackPanel>

            <ItemsControl Grid.Row="1" ItemsSource="{x:Bind LegendItems}" ItemTemplate="{StaticResource LegendItemTemplate}" HorizontalAlignment="Right" VerticalAlignment="Top"/>
        </Grid>

    </Grid>
</UserControl>
